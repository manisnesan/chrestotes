<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Tracking Data and Model in Machine Learning projects</h1><p class="page-description">DVC as tool for model and data versioning and create reproducible ML project.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-06-29T00:00:00-05:00" itemprop="datePublished">
        Jun 29, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      1 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/chrestotes/categories/#machine-learning">machine-learning</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#why-should-you-track-everything">Why should you track everything</a></li>
<li class="toc-entry toc-h2"><a href="#dvc">DVC</a>
<ul>
<li class="toc-entry toc-h3"><a href="#install-dvc-on-fedorarhelcentos">Install DVC on Fedora/RHEL/CentOS</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#workflow-for-model-packaging">Workflow for Model Packaging</a>
<ul>
<li class="toc-entry toc-h3"><a href="#pushing-model-files">Pushing model files</a></li>
<li class="toc-entry toc-h3"><a href="#pulling-the-model">Pulling the model</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#food-for-thought">Food for thought</a></li>
<li class="toc-entry toc-h2"><a href="#references">References</a></li>
</ul><h2 id="why-should-you-track-everything">
<a class="anchor" href="#why-should-you-track-everything" aria-hidden="true"><span class="octicon octicon-link"></span></a>Why should you track everything</h2>

<ul>
  <li>Difference between software engineering and machine learning projects</li>
  <li>code, config, dependencies vs code, data, model, config, dependencies</li>
  <li>Myriad of Data files (raw, intermediate)</li>
  <li>Not in repository</li>
  <li>Reproducible ML models targeting metrics [Experiments Link]</li>
  <li>Tuning and Experimentation tracking</li>
  <li>Model Deployment &amp; Revert</li>
</ul>

<h2 id="dvc">
<a class="anchor" href="#dvc" aria-hidden="true"><span class="octicon octicon-link"></span></a>DVC</h2>

<ul>
  <li>
    <p>DVC is built to make ML models shareable and reproducible. It is designed to handle large files, data sets, machine learning models, and metrics as well as code.</p>
  </li>
  <li>Experiments are tracked by combining the Code + Data files</li>
  <li>Data files
    <ul>
      <li>Local cache</li>
      <li>Data remotes in S3, SSH etc</li>
    </ul>
  </li>
  <li>Metrics per experiment</li>
  <li>Pipelines</li>
</ul>

<h3 id="install-dvc-on-fedorarhelcentos">
<a class="anchor" href="#install-dvc-on-fedorarhelcentos" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install DVC on Fedora/RHEL/CentOS</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>wget https://dvc.org/rpm/dvc.repo <span class="nt">-O</span> /etc/yum.repos.d/dvc.repo
<span class="nb">sudo </span>yum update
<span class="nb">sudo </span>yum <span class="nb">install </span>dvc
</code></pre></div></div>

<p>Add DVC files in the Git (It is not required but it is good to have project and dvc config in the same directory)</p>

<h2 id="workflow-for-model-packaging">
<a class="anchor" href="#workflow-for-model-packaging" aria-hidden="true"><span class="octicon octicon-link"></span></a>Workflow for Model Packaging</h2>

<ul>
  <li>Setup for connecting to model repository during training development process</li>
  <li>Push the trained model to the repository</li>
  <li>Pull the model from the repository during the build process</li>
</ul>

<h3 id="pushing-model-files">
<a class="anchor" href="#pushing-model-files" aria-hidden="true"><span class="octicon octicon-link"></span></a>Pushing model files</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dvc init
dvc remote add <span class="nt">-d</span> gss-rdu-remote ssh://msivanes@gss-rdu-repo.usersys.redhat.com:/var/www/html/repo/config/ulmfit

dvc add cases_small_sbr_08-06-2020.pkl
git commit <span class="nt">-am</span> “Add ulmfit model to project”
dvc push <span class="nt">-v</span>
</code></pre></div></div>

<h3 id="pulling-the-model">
<a class="anchor" href="#pulling-the-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Pulling the model</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone <span class="nv">$REPO</span>
git pull
dvc pull <span class="c"># Pulls the data from remote-storage. Equivalent to dvc fetch followed by dvc checkout</span>
dvc checkout <span class="c">#Update model files</span>
</code></pre></div></div>

<h2 id="food-for-thought">
<a class="anchor" href="#food-for-thought" aria-hidden="true"><span class="octicon octicon-link"></span></a>Food for thought</h2>

<ul>
  <li>Rather than feature branches, think in terms of experiment branches targeting metrics.</li>
  <li>Keep Data and Model files stored outside the repository</li>
  <li>Model files built as part of build process.</li>
  <li>Smoke test should validate the constructed model using validation set.</li>
</ul>

<h2 id="references">
<a class="anchor" href="#references" aria-hidden="true"><span class="octicon octicon-link"></span></a>References</h2>

<ul>
  <li><a href="https://dvc.org/doc">DVC</a></li>
  <li><a href="https://www.globalsqa.com/dvc-cheat-sheet/">Cheatsheet</a></li>
  <li>https://christophergs.github.io/machine%20learning/2019/05/13/first-impressions-of-dvc/</li>
  <li>https://www.slideshare.net/DmitryPetrov15/pydata-berlin-2018-dvcorg</li>
</ul>

  </div><a class="u-url" href="/chrestotes/posts/2020-06-29-tracking-data-model-using-dvc.html" hidden></a>
</article>